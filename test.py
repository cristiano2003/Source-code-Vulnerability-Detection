y_true = [[1, 2, 1], [3, 2, 1]]
y_pred = [[3, 1, 2], [4, 3, 1]]
import torch 

print(torch.tensor(y_true))
a = torch.tensor(y_true).argmax(dim=1)
print(torch.tensor(y_pred))
b = torch.tensor(y_pred).argmax(dim=1)

from sklearn.metrics import f1_score

print(f1_score(a, b, average='macro'))

acc = (a == b).float().mean()

print(acc)